# Bluetooth JDY-33 Relay Bridge (Home Assistant add-on)

MQTT-–º–æ—Å—Ç –¥–ª—è Bluetooth-–º–æ–¥—É–ª–µ–π **JDY-33-BLE** (—Å–æ–≤–º–µ—Å—Ç–∏–º —Å BT05 / JDY-08, –Ω–æ —ç—Ç–æ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è), —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –ø–æ BLE (GATT).

–ê–¥–¥–æ–Ω –ø—É–±–ª–∏–∫—É–µ—Ç –≤ Home Assistant MQTT-—Å–≤–∏—Ç—á —á–µ—Ä–µ–∑ **MQTT Discovery** –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–ª–µ –ø–æ BLE (—á–µ—Ä–µ–∑ GATT-—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫—É).

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–∞–ø–∫—É `bluetooth-jdy33-relay-bridge` –≤ –∫–∞—Ç–∞–ª–æ–≥ `/addons/` –≤–∞—à–µ–≥–æ Home Assistant.
2. –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ HA –æ—Ç–∫—Ä–æ–π—Ç–µ:  
   **Settings ‚Üí Add-ons ‚Üí Local add-ons ‚Üí Bluetooth JDY-33 Relay Bridge ‚Üí Install**.
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∞–¥–¥–æ–Ω, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ **Start**.

---

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

| –û–ø—Ü–∏—è | –¢–∏–ø | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|-----------------------|----------|
| `MQTT_HOST` | str | `core-mosquitto` | –•–æ—Å—Ç –±—Ä–æ–∫–µ—Ä–∞ MQTT |
| `MQTT_PORT` | int | `1883` | –ü–æ—Ä—Ç –±—Ä–æ–∫–µ—Ä–∞ MQTT |
| `MQTT_USER` | str | `mqtt` | –õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è MQTT |
| `MQTT_PASS` | str | `mqtt` | –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è MQTT |
| `MQTT_PREFIX` | str | `bluetoothrelay` | –ü—Ä–µ—Ñ–∏–∫—Å —Ç–æ–ø–∏–∫–æ–≤ –¥–ª—è —Å–≤–∏—Ç—á–∞ |

| `RELAY_NAME` | str | `Bluetooth JDY-33 Relay` | –ò–º—è —Å–≤–∏—Ç—á–∞ –≤ Home Assistant |
| `RELAY_ID` | str | `jdy33_relay` | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å—É—â–Ω–æ—Å—Ç–∏ |

| `BLE_ADDR` | str | –ø—É—Å—Ç–æ | MAC-–∞–¥—Ä–µ—Å –º–æ–¥—É–ª—è JDY-33. –ï—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî –±—É–¥–µ—Ç –ø–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ-–ø–æ–∏—Å–∫–∞ –ø–æ –∏–º–µ–Ω–∏ |
| `BLE_NAME` | str | `JDY` | –ò–º—è BLE-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ (–µ—Å–ª–∏ `BLE_ADDR` –Ω–µ –∑–∞–¥–∞–Ω) |
| `BLE_WRITE_CHAR` | str | `0000ffe1-0000-1000-8000-00805f9b34fb` | UUID GATT-—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–ª—è –∑–∞–ø–∏—Å–∏ –∫–æ–º–∞–Ω–¥ |

| `CONNECTION_MODE` | enum | `ON_DEMAND` | –†–µ–∂–∏–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: `ON_DEMAND` –∏–ª–∏ `PERSISTENT` (–º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ —É–∫–∞–∑–∞—Ç—å `true/false`) |
| `IDLE_DISCONNECT_SEC` | int | `5` | –¢–∞–π–º–∞—É—Ç –ø—Ä–æ—Å—Ç–æ—è –¥–ª—è —Ä–µ–∂–∏–º–∞ `ON_DEMAND` (—Å–µ–∫—É–Ω–¥—ã) ‚Äî –ø–æ—Å–ª–µ –Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç—Å—è |
| `PERSISTENT_HEALTH_SEC` | int | `30` | –ò–Ω—Ç–µ—Ä–≤–∞–ª health-check –≤ —Ä–µ–∂–∏–º–µ `PERSISTENT` (—Å–µ–∫—É–Ω–¥—ã). –ï—Å–ª–∏ `0` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã |

| `CMD_ON_HEX` | str | `A00101A2` | HEX-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–ª–µ |
| `CMD_OFF_HEX` | str | `A00100A1` | HEX-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –≤—ã–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–ª–µ |

---

## üß© MQTT-—Ç–æ–ø–∏–∫–∏

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–¥–¥–æ–Ω –ø—É–±–ª–∏–∫—É–µ—Ç MQTT Discovery –≤ —Ç–æ–ø–∏–∫–µ:

- `homeassistant/switch/<RELAY_ID>/config`

–ì–¥–µ `<RELAY_ID>` ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `jdy33_relay`).

–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ —Ç–æ–ø–∏–∫–∏:

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –¢–æ–ø–∏–∫ | –ó–Ω–∞—á–µ–Ω–∏—è |
|-----------|-------|----------|
| –ö–æ–º–∞–Ω–¥–∞ | `<MQTT_PREFIX>/set` | `ON` / `OFF` |
| –°–æ—Å—Ç–æ—è–Ω–∏–µ | `<MQTT_PREFIX>/state` | `ON` / `OFF` |
| –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å | `<MQTT_PREFIX>/availability` | `online` / `offline` |

---

## üîå –†–µ–∂–∏–º—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**ON_DEMAND**

- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ JDY-33 –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã `ON`/`OFF`.
- –ü–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã –∏ —Ç–∞–π–º–∞—É—Ç–∞ `IDLE_DISCONNECT_SEC` —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä—ã–≤–∞–µ—Ç—Å—è.
- –ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ —Ä–µ–ª–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ –∏ –≤–∞–∂–Ω–µ–µ —ç–∫–æ–Ω–æ–º–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã.

**PERSISTENT**

- –ê–¥–¥–æ–Ω —Å—Ç–∞—Ä–∞–µ—Ç—Å—è –¥–µ—Ä–∂–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ.
- –†–∞–∑ –≤ `PERSISTENT_HEALTH_SEC` —Å–µ–∫—É–Ω–¥ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è health-check:
  - –µ—Å–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ, –∞–¥–¥–æ–Ω –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è;
  - –≤ –ª–æ–≥ –ø–∏—à—É—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–æ–ø—ã—Ç–∫–∞—Ö –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö.
- –ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏ —Ä–µ–ª–µ –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ –≤–∞–∂–µ–Ω –±—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–ª–∏–∫.
